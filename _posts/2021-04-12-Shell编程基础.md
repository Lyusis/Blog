---
layout: mypost
title: Shell编程基础
categories: [Shell]
---

# Shell编程基础

## 变量

### 自定义变量

1. 变量是由任何字母、数字、和下划线组成的字符串, 且不能以数字开头.
2. 区分字母大小写, 例如Var1和var1是不同的
3. 变量、等号、值中间不能出现任何空格

```shell
var1=hello
echo $var1
```

### 位置参数变量

1. $n: n为数字, $0代表脚本本身, $1~$9代表第1~9个参数, 10以上的参数需要用大括号表示, 如${10}
2. $@: 代表命令行所有参数, 但是每个参数区别对待
3. $*: 代表命令行所有参数, 所有参数视为一个整体
4. $#: 参数个数

### 环境变量

1. 简介: Linux是一个多租户的操作系统, 针对不同的用户都会有一个专有的运行环境, 不同的专有环境就是一主默认环境变量的组合.
2. 对所有用户生效的环境变量: /etc/profile
3. 对特定用户生效的环境变量: ~/.bashrc 或者 ~/.bash_profile
4. 临时有效的环境变量: 脚本或命令行使用export
5. 常用环境变量

| 环境变量 | 含义                       |
| :------- | :------------------------- |
| PATH     | 命令搜索的路径             |
| HOME     | 用户家目录的路径           |
| LOGNAME  | 用户登录名                 |
| PWD      | 当前所在路径               |
| HISTFILE | 历史命令的保存文件         |
| HSTSIZE  | 历史命令保存的最大行数     |
| HOSTNAME | 主机名                     |
| SHELL    | 用户当前使用的SHELL        |
| PS1      | 一级命令提示符             |
| TMOUT    | 用户和系统交互过程的超时值 |
| IFS      | 系统输入分隔符             |
| OFS      | 系统输出分割符             |

### 管道

`|`符号即为管道, 意为将前一个命令的结果传递给后续命令, 可以连续传递

从某种意义上来说, 是重定向的一种实现

### 退出状态码

1. 所有的shell命令都是使用退出状态码来告知shell它已执行完毕
2. 退出状态码是一个0~255的整数值
3. Linux提供了一个`$?`来捕获退出状态码的值, 重点在于: 0代表命令执行成功, 非0代表命令执行失败

| 状态码 | 含义                       |
| ------ | -------------------------- |
| 0      | 命令成功结束               |
| 1      | 一般性未知错误             |
| 2      | 不适合的shell命令          |
| 126    | 命令不可执行               |
| 127    | 没找到命令                 |
| 128    | 无效的退出参数             |
| 128+x  | 与Linux信号x相关的严重错误 |
| 130    | 通过Ctrl+C终止的命令       |
| 255    | 正常范围之外的退出码       |

```shell
cat $description/$time-$1.md | while read line; 
    do
    		# -z 判断字符串长度是否等于0, -n 判断字符串长度是否大于0
        if [ -z $line ]; then 
            break;
        else
            echo "已存在文件, 请确认"
            exit 1
        fi
    done
# 以上的代码并不会因为exit 1 而直接退出, 因为包裹在了while语句当中, 类似于break操作
# 如果需要确实地退出, 需要在外部再做一次判断
if [ $? -eq 1 ]; then
    exit 1
fi
```

## IF语句

### 语法

```shell
if command | condition #注意:shell中判断符`==``!=`等的左右两边必须空格
then
	commands
elif command | condition
then
	commands
else
	commands
fi
```



